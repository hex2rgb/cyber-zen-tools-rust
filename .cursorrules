# Cursor Rules - 代码修改对话模式

## 核心规则：代码修改前的必要流程

### ⚠️ 重要：修改代码前的强制流程

在修改任何工程代码之前，必须严格遵循以下三步流程：

#### 第一步：先解释原因
在提出任何代码修改之前，必须：
- **详细说明为什么需要修改**
  - 解释问题的根本原因
  - 分析当前实现的问题
  - 说明修改的必要性
- **对比分析**
  - 如果是迁移项目，必须说明原项目的实现方式
  - 对比原项目与当前项目的差异
  - 说明技术限制或约束
- **提供方案（如果有多个）**
  - 列出所有可行的解决方案
  - 说明每个方案的优缺点
  - 说明每个方案的影响和风险

#### 第二步：等待用户明确认可
在用户明确认可之前，**禁止执行任何代码修改**：
- 用户必须明确认可你的解释
- 如果有多个方案，必须等待用户明确选择
- 用户必须明确允许你执行修改
- **不得假设用户意图**
- **不得在解释阶段就修改代码**

#### 第三步：获得许可后才能修改
只有在获得用户明确许可后，才能：
- 执行代码修改
- 创建或删除文件
- 修改配置文件
- 运行可能改变系统的命令

### 禁止的行为

以下行为严格禁止：
- ❌ 在解释原因之前就修改代码
- ❌ 假设用户意图并直接修改
- ❌ 在用户未明确许可时执行修改
- ❌ 跳过解释步骤直接提供解决方案
- ❌ 在解释中夹带代码修改

### 正确的对话模式示例

#### ✅ 正确示例：

```
用户：构建失败了
AI：
【第一步：解释原因】
问题分析：
- 错误信息显示：xxx
- 根本原因：xxx
- 这是因为：xxx

【第二步：提供方案】
解决方案：
- 方案1：xxx（优点：xxx，缺点：xxx）
- 方案2：xxx（优点：xxx，缺点：xxx）

【第三步：等待确认】
请选择方案，确认后我将执行修改。
```

#### ❌ 错误示例：

```
用户：构建失败了
AI：直接修改代码（没有解释，没有等待确认）
```

### 特殊情况处理

#### 如果是迁移项目：
- 必须保持原项目的结构和风格
- 禁止"优化"或"简化"，除非用户明确要求
- 禁止添加"简化版本"等标注
- 必须完全迁移，不得遗漏

#### 如果是修复错误：
- 必须先说明错误原因
- 说明修复方案
- 等待用户确认后再修复

#### 如果是添加功能：
- 必须先说明需求理解
- 说明实现方案
- 等待用户确认后再实现

### 技术决策规则

遇到技术限制或需要做技术决策时：
1. 先解释技术限制的原因
2. 提供所有可行的技术方案
3. 说明每个方案的技术细节和影响
4. 等待用户明确选择
5. 获得许可后再实施

### 对话流程检查清单

在每次代码修改前，必须确认：
- [ ] 已详细解释原因
- [ ] 已说明问题根本原因
- [ ] 已提供方案（如有多个）
- [ ] 已说明方案优缺点
- [ ] 已等待用户明确认可
- [ ] 已获得用户明确许可
- [ ] 然后才能执行修改

## 项目特定规则（Cyber Zen Tools Rust）

### Rust 项目规则
- 使用官方 Rust 安装方式（rustup），禁止使用 `brew install rust`
- 保持与 Go 版本相同的配置文件格式和路径
- 保持与 Go 版本相同的命令接口

### 构建系统规则
- Makefile 必须保持原项目的结构和注释风格
- 脚本文件必须保持原项目的风格，只做必要的技术适配
- 不得添加"简化版本"等标注
